# Modbus Register CLI Manager

–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–µ —Ç–µ—Ä–º–∏–Ω–∞–ª—å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö Modbus —Ä–µ–≥–∏—Å—Ç—Ä–æ–≤.

## –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### üìã –ü—Ä–æ—Å–º–æ—Ç—Ä —Ä–µ–≥–∏—Å—Ç—Ä–æ–≤
- –í—Å–µ —Ä–µ–≥–∏—Å—Ç—Ä—ã (–æ–±—â–∏–π —Å–ø–∏—Å–æ–∫)
- Holding Registers (SCADA ‚Üí PLC)
- Input Registers (PLC ‚Üí SCADA)
- –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ —Å–µ–∫—Ü–∏–∏
- –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ —Ç–∏–ø—É –¥–∞–Ω–Ω—ã—Ö
- –ü–∞–≥–∏–Ω–∞—Ü–∏—è (–ø–æ 50 –∑–∞–ø–∏—Å–µ–π)
- –¶–≤–µ—Ç–æ–≤–æ–µ –≤—ã–¥–µ–ª–µ–Ω–∏–µ —Ç–∏–ø–æ–≤ –¥–∞–Ω–Ω—ã—Ö:
  - üîµ **BOOL** - –≥–æ–ª—É–±–æ–π
  - üü¢ **REAL** - –∑–µ–ª—ë–Ω—ã–π
  - ‚ö™ **INT/UINT/WORD** - –±–µ–ª—ã–π

### ‚ûï –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ä–µ–≥–∏—Å—Ç—Ä–æ–≤
- –ü–æ—à–∞–≥–æ–≤—ã–π –º–∞—Å—Ç–µ—Ä —Å –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π:
  1. –í—ã–±–æ—Ä —Ç–∏–ø–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞ (Holding/Input)
  2. –í—ã–±–æ—Ä —Å–µ–∫—Ü–∏–∏ –∏–∑ —Å–ø–∏—Å–∫–∞
  3. –í—ã–±–æ—Ä —Ç–∏–ø–∞ –¥–∞–Ω–Ω—ã—Ö (BOOL/REAL/INT/etc.)
  4. –í–≤–æ–¥ –∞–¥—Ä–µ—Å–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞
  5. –í–≤–æ–¥ –±–∏—Ç-–∏–Ω–¥–µ–∫—Å–∞ (–¥–ª—è BOOL)
  6. –í–≤–æ–¥ –∏–º–µ–Ω–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π PLC
  7. –í–≤–æ–¥ –æ–ø–∏—Å–∞–Ω–∏—è (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç–∏ –∞–¥—Ä–µ—Å–∞
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ FOREIGN KEY constraints

### ‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–≥–∏—Å—Ç—Ä–æ–≤
- –ü–æ–∏—Å–∫ –ø–æ ID —Ä–µ–≥–∏—Å—Ç—Ä–∞
- –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ç–µ–∫—É—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö
- –ò–∑–º–µ–Ω–µ–Ω–∏–µ:
  - –ò–º–µ–Ω–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π
  - –û–ø–∏—Å–∞–Ω–∏—è
  - –£–¥–∞–ª–µ–Ω–∏–µ –æ–ø–∏—Å–∞–Ω–∏—è

### üóëÔ∏è –£–¥–∞–ª–µ–Ω–∏–µ —Ä–µ–≥–∏—Å—Ç—Ä–æ–≤
- –ü–æ–∏—Å–∫ –ø–æ ID
- –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø–æ–ª–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –ø–µ—Ä–µ–¥ —É–¥–∞–ª–µ–Ω–∏–µ–º
- –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ —É–¥–∞–ª–µ–Ω–∏—è (—Ç—Ä–µ–±—É–µ—Ç—Å—è –≤–≤–µ—Å—Ç–∏ "YES")
- –ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π —Å–≤—è–∑–µ–π

### üîç –ü–æ–∏—Å–∫ —Ä–µ–≥–∏—Å—Ç—Ä–æ–≤
- –ü–æ–ª–Ω–æ—Ç–µ–∫—Å—Ç–æ–≤—ã–π –ø–æ–∏—Å–∫ –ø–æ:
  - –ò–º–µ–Ω–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π (variable_name)
  - –û–ø–∏—Å–∞–Ω–∏—é (description)
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —á–∞—Å—Ç–∏—á–Ω–æ–≥–æ —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è (LIKE)
- –õ–∏–º–∏—Ç: 100 —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
- –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ –∞–¥—Ä–µ—Å—É

### üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
- –û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:
  - –í—Å–µ–≥–æ —Ä–µ–≥–∏—Å—Ç—Ä–æ–≤
  - –í—Å–µ–≥–æ —Å–µ–∫—Ü–∏–π
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ —Ç–∏–ø–∞–º —Ä–µ–≥–∏—Å—Ç—Ä–æ–≤:
  - Holding Registers
  - Input Registers
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ —Ç–∏–ø–∞–º –¥–∞–Ω–Ω—ã—Ö:
  - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ BOOL/REAL/INT/etc.
- –¢–æ–ø-10 —Å–µ–∫—Ü–∏–π –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É —Ä–µ–≥–∏—Å—Ç—Ä–æ–≤

### üì§ –≠–∫—Å–ø–æ—Ä—Ç –≤ Excel
- –ó–∞–ø—É—Å–∫ –≤–Ω–µ—à–Ω–µ–≥–æ —Å–∫—Ä–∏–ø—Ç–∞ `export_to_excel.py`
- –°–æ–∑–¥–∞–Ω–∏–µ —Ñ–∞–π–ª–∞ `modbus_map.xlsx` —Å:
  - –õ–∏—Å—Ç "Holding Registers"
  - –õ–∏—Å—Ç "Input Registers"
  - –õ–∏—Å—Ç "–†–µ–∑–µ—Ä–≤—ã"
  - –õ–∏—Å—Ç "–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞"
- –¶–≤–µ—Ç–æ–≤–æ–µ –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–∏–ø–æ–≤ –¥–∞–Ω–Ω—ã—Ö
- –ê–≤—Ç–æ—à–∏—Ä–∏–Ω–∞ –∫–æ–ª–æ–Ω–æ–∫
- –ó–∞–∫—Ä–µ–ø–ª—ë–Ω–Ω—ã–µ –∑–∞–≥–æ–ª–æ–≤–∫–∏
- –ê–≤—Ç–æ—Ñ–∏–ª—å—Ç—Ä

### üîß –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–µ–∫—Ü–∏—è–º–∏
- –ü—Ä–æ—Å–º–æ—Ç—Ä –≤—Å–µ—Ö —Å–µ–∫—Ü–∏–π —Å:
  - –ù–∞–∑–≤–∞–Ω–∏–µ–º
  - –î–∏–∞–ø–∞–∑–æ–Ω–æ–º –∞–¥—Ä–µ—Å–æ–≤
  - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ–º —Ä–µ–≥–∏—Å—Ç—Ä–æ–≤
  - –¢–∏–ø–æ–º —Ä–µ–≥–∏—Å—Ç—Ä–∞
- –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–π —Å–µ–∫—Ü–∏–∏:
  - –í—ã–±–æ—Ä —Ç–∏–ø–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞
  - –í–≤–æ–¥ –Ω–∞–∑–≤–∞–Ω–∏—è
  - –í–≤–æ–¥ –¥–∏–∞–ø–∞–∑–æ–Ω–∞ (start-end)
  - –û–ø–∏—Å–∞–Ω–∏–µ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- –£–¥–∞–ª–µ–Ω–∏–µ —Å–µ–∫—Ü–∏–∏:
  - –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –Ω–∞–ª–∏—á–∏–µ —Ä–µ–≥–∏—Å—Ç—Ä–æ–≤
  - –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ —É–¥–∞–ª–µ–Ω–∏—è

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è
- Python 3.8+
- SQLite3
- openpyxl (–¥–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∞ –≤ Excel)

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

#### –í–∞—Ä–∏–∞–Ω—Ç 1: –í–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
```bash
cd /home/dmalikov/dev/cc_kush_rewrite/newProject
python3 -m venv venv
source venv/bin/activate
pip install openpyxl
```

#### –í–∞—Ä–∏–∞–Ω—Ç 2: –°–∏—Å—Ç–µ–º–Ω—ã–π Python
```bash
pip3 install openpyxl
```

### –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

#### –ß–µ—Ä–µ–∑ shell —Å–∫—Ä–∏–ø—Ç (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
```bash
cd /home/dmalikov/dev/cc_kush_rewrite/newProject/script
./modbus_cli.sh
```

Shell —Å–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–∞–ª–∏—á–∏–µ Python 3
- –ê–∫—Ç–∏–≤–∏—Ä—É–µ—Ç –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ (–µ—Å–ª–∏ –µ—Å—Ç—å)
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–∞–ª–∏—á–∏–µ openpyxl
- –ó–∞–ø—É—Å–∫–∞–µ—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ

#### –ß–µ—Ä–µ–∑ Python –Ω–∞–ø—Ä—è–º—É—é
```bash
cd /home/dmalikov/dev/cc_kush_rewrite/newProject/script
python3 modbus_cli.py
```

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –º–µ–Ω—é

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ       MODBUS REGISTER DATABASE MANAGER          ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

–ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
1. üìã –ü—Ä–æ—Å–º–æ—Ç—Ä —Ä–µ–≥–∏—Å—Ç—Ä–æ–≤
   ‚îú‚îÄ‚îÄ –í—Å–µ —Ä–µ–≥–∏—Å—Ç—Ä—ã
   ‚îú‚îÄ‚îÄ Holding Registers (SCADA ‚Üí PLC)
   ‚îú‚îÄ‚îÄ Input Registers (PLC ‚Üí SCADA)
   ‚îú‚îÄ‚îÄ –ü–æ —Å–µ–∫—Ü–∏–∏
   ‚îî‚îÄ‚îÄ –ü–æ —Ç–∏–ø—É –¥–∞–Ω–Ω—ã—Ö

2. ‚ûï –î–æ–±–∞–≤–∏—Ç—å —Ä–µ–≥–∏—Å—Ç—Ä
   ‚îî‚îÄ‚îÄ –ú–∞—Å—Ç–µ—Ä –¥–æ–±–∞–≤–ª–µ–Ω–∏—è (7 —à–∞–≥–æ–≤)

3. ‚úèÔ∏è  –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–≥–∏—Å—Ç—Ä
   ‚îú‚îÄ‚îÄ –ü–æ–∏—Å–∫ –ø–æ ID
   ‚îî‚îÄ‚îÄ –í—ã–±–æ—Ä –ø–æ–ª—è –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

4. üóëÔ∏è  –£–¥–∞–ª–∏—Ç—å —Ä–µ–≥–∏—Å—Ç—Ä
   ‚îî‚îÄ‚îÄ –ü–æ–∏—Å–∫ –ø–æ ID + –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ

5. üîç –ü–æ–∏—Å–∫ —Ä–µ–≥–∏—Å—Ç—Ä–æ–≤
   ‚îî‚îÄ‚îÄ –ü–æ–∏—Å–∫ –ø–æ –∏–º–µ–Ω–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –∏–ª–∏ –æ–ø–∏—Å–∞–Ω–∏—é

6. üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ë–î
   ‚îî‚îÄ‚îÄ –û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ + —Ç–æ–ø-10 —Å–µ–∫—Ü–∏–π

7. üì§ –≠–∫—Å–ø–æ—Ä—Ç –≤ Excel
   ‚îî‚îÄ‚îÄ –ó–∞–ø—É—Å–∫ export_to_excel.py

8. üîß –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–µ–∫—Ü–∏—è–º–∏
   ‚îú‚îÄ‚îÄ –ü—Ä–æ—Å–º–æ—Ç—Ä –≤—Å–µ—Ö —Å–µ–∫—Ü–∏–π
   ‚îú‚îÄ‚îÄ –î–æ–±–∞–≤–∏—Ç—å —Å–µ–∫—Ü–∏—é
   ‚îú‚îÄ‚îÄ –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–µ–∫—Ü–∏—é
   ‚îî‚îÄ‚îÄ –£–¥–∞–ª–∏—Ç—å —Å–µ–∫—Ü–∏—é

0. –í—ã—Ö–æ–¥
```

## –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ BOOL —Ä–µ–≥–∏—Å—Ç—Ä–∞
```
1. –ó–∞–ø—É—Å—Ç–∏—Ç—å: ./modbus_cli.sh
2. –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é ‚Üí 2 (–î–æ–±–∞–≤–∏—Ç—å —Ä–µ–≥–∏—Å—Ç—Ä)
3. –í—ã–±—Ä–∞—Ç—å —Ç–∏–ø —Ä–µ–≥–∏—Å—Ç—Ä–∞: 1 (Holding Registers)
4. –í—ã–±—Ä–∞—Ç—å —Å–µ–∫—Ü–∏—é: –Ω–∞–ø—Ä–∏–º–µ—Ä, 10 (–ö–æ–º–∞–Ω–¥—ã –æ–±—â–∏–µ)
5. –í—ã–±—Ä–∞—Ç—å —Ç–∏–ø –¥–∞–Ω–Ω—ã—Ö: 1 (BOOL)
6. –í–≤–µ—Å—Ç–∏ –∞–¥—Ä–µ—Å: 0
7. –í–≤–µ—Å—Ç–∏ –±–∏—Ç-–∏–Ω–¥–µ–∫—Å: 0
8. –í–≤–µ—Å—Ç–∏ –∏–º—è –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π: cmdStart
9. –í–≤–µ—Å—Ç–∏ –æ–ø–∏—Å–∞–Ω–∏–µ: –ö–æ–º–∞–Ω–¥–∞ —Å—Ç–∞—Ä—Ç–∞ —Å–∏—Å—Ç–µ–º—ã
```

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ REAL —Ä–µ–≥–∏—Å—Ç—Ä–∞
```
1. –ó–∞–ø—É—Å—Ç–∏—Ç—å: ./modbus_cli.sh
2. –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é ‚Üí 2 (–î–æ–±–∞–≤–∏—Ç—å —Ä–µ–≥–∏—Å—Ç—Ä)
3. –í—ã–±—Ä–∞—Ç—å —Ç–∏–ø —Ä–µ–≥–∏—Å—Ç—Ä–∞: 2 (Input Registers)
4. –í—ã–±—Ä–∞—Ç—å —Å–µ–∫—Ü–∏—é: –Ω–∞–ø—Ä–∏–º–µ—Ä, 3 (–ë—É–Ω–∫–µ—Ä 1 –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥)
5. –í—ã–±—Ä–∞—Ç—å —Ç–∏–ø –¥–∞–Ω–Ω—ã—Ö: 2 (REAL)
6. –í–≤–µ—Å—Ç–∏ –∞–¥—Ä–µ—Å: 30
7. –ë–∏—Ç-–∏–Ω–¥–µ–∫—Å: (–ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å –¥–ª—è REAL)
8. –í–≤–µ—Å—Ç–∏ –∏–º—è –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π: stBunker[1].rWeight
9. –í–≤–µ—Å—Ç–∏ –æ–ø–∏—Å–∞–Ω–∏–µ: –í–µ—Å –≤ –±—É–Ω–∫–µ—Ä–µ 1
```

### –ü–æ–∏—Å–∫ —Ä–µ–≥–∏—Å—Ç—Ä–æ–≤
```
1. –ó–∞–ø—É—Å—Ç–∏—Ç—å: ./modbus_cli.sh
2. –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é ‚Üí 5 (–ü–æ–∏—Å–∫ —Ä–µ–≥–∏—Å—Ç—Ä–æ–≤)
3. –í–≤–µ—Å—Ç–∏: "Bunker"
   ‚Üí –ù–∞–π–¥—ë—Ç –≤—Å–µ —Ä–µ–≥–∏—Å—Ç—Ä—ã, —Å–æ–¥–µ—Ä–∂–∞—â–∏–µ "Bunker" –≤ –∏–º–µ–Ω–∏ –∏–ª–∏ –æ–ø–∏—Å–∞–Ω–∏–∏
```

### –≠–∫—Å–ø–æ—Ä—Ç –≤ Excel
```
1. –ó–∞–ø—É—Å—Ç–∏—Ç—å: ./modbus_cli.sh
2. –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é ‚Üí 7 (–≠–∫—Å–ø–æ—Ä—Ç –≤ Excel)
   ‚Üí –°–æ–∑–¥–∞—Å—Ç —Ñ–∞–π–ª: script/modbus_map.xlsx
```

## –¶–≤–µ—Ç–æ–≤–∞—è —Å—Ö–µ–º–∞

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç ANSI —Ü–≤–µ—Ç–∞ –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è —á–∏—Ç–∞–µ–º–æ—Å—Ç–∏:

| –≠–ª–µ–º–µ–Ω—Ç               | –¶–≤–µ—Ç              | ANSI –∫–æ–¥       |
|-----------------------|-------------------|----------------|
| –ó–∞–≥–æ–ª–æ–≤–∫–∏             | –ü—É—Ä–ø—É—Ä–Ω—ã–π (–∂–∏—Ä–Ω—ã–π)| `\033[1;95m`   |
| –ü–æ–¥–∑–∞–≥–æ–ª–æ–≤–∫–∏          | –ì–æ–ª—É–±–æ–π           | `\033[96m`     |
| –û–ø—Ü–∏–∏ –º–µ–Ω—é            | –°–∏–Ω–∏–π             | `\033[94m`     |
| –£—Å–ø–µ—Ö                 | –ó–µ–ª—ë–Ω—ã–π           | `\033[92m`     |
| –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è        | –ñ—ë–ª—Ç—ã–π            | `\033[93m`     |
| –û—à–∏–±–∫–∏                | –ö—Ä–∞—Å–Ω—ã–π           | `\033[91m`     |
| BOOL —Ä–µ–≥–∏—Å—Ç—Ä—ã         | –ì–æ–ª—É–±–æ–π           | `\033[96m`     |
| REAL —Ä–µ–≥–∏—Å—Ç—Ä—ã         | –ó–µ–ª—ë–Ω—ã–π           | `\033[92m`     |

## –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Å–ª–µ–¥—É—é—â–∏–µ —Ç–∏–ø—ã –æ—à–∏–±–æ–∫:

### –û—à–∏–±–∫–∏ –ë–î
- **–î—É–±–ª–∏–∫–∞—Ç –∞–¥—Ä–µ—Å–∞**: –ü—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ –¥–æ–±–∞–≤–∏—Ç—å —Ä–µ–≥–∏—Å—Ç—Ä —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º –∞–¥—Ä–µ—Å–æ–º
  ```
  ‚ùå –û—à–∏–±–∫–∞: —Ä–µ–≥–∏—Å—Ç—Ä —Å —Ç–∞–∫–∏–º –∞–¥—Ä–µ—Å–æ–º —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
     UNIQUE constraint failed: registers.register_address
  ```

- **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Å–µ–∫—Ü–∏–π**: –ü—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ –¥–æ–±–∞–≤–∏—Ç—å —Ä–µ–≥–∏—Å—Ç—Ä –≤ –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â—É—é —Å–µ–∫—Ü–∏—é
  ```
  ‚ùå –°–µ–∫—Ü–∏–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã –¥–ª—è –¥–∞–Ω–Ω–æ–≥–æ —Ç–∏–ø–∞ —Ä–µ–≥–∏—Å—Ç—Ä–æ–≤
  ```

- **–£–¥–∞–ª–µ–Ω–∏–µ —Å–µ–∫—Ü–∏–∏ —Å —Ä–µ–≥–∏—Å—Ç—Ä–∞–º–∏**: –ü—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ —É–¥–∞–ª–∏—Ç—å —Å–µ–∫—Ü–∏—é —Å –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
  ```
  ‚ùå –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ —É–¥–∞–ª–∏—Ç—å —Å–µ–∫—Ü–∏—é: –≤ –Ω–µ–π 25 —Ä–µ–≥–∏—Å—Ç—Ä–æ–≤
     –°–Ω–∞—á–∞–ª–∞ —É–¥–∞–ª–∏—Ç–µ –≤—Å–µ —Ä–µ–≥–∏—Å—Ç—Ä—ã –∏–∑ —Å–µ–∫—Ü–∏–∏
  ```

### –û—à–∏–±–∫–∏ –≤–≤–æ–¥–∞
- –ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –≤–≤–æ–¥ —á–∏—Å–ª–∞ ‚Üí –ø–æ–≤—Ç–æ—Ä–Ω—ã–π –∑–∞–ø—Ä–æ—Å
- –ü—É—Å—Ç–æ–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ –ø–æ–ª–µ ‚Üí —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ
- –í—ã—Ö–æ–¥ –∑–∞ –¥–∏–∞–ø–∞–∑–æ–Ω (–Ω–∞–ø—Ä–∏–º–µ—Ä, –±–∏—Ç-–∏–Ω–¥–µ–∫—Å > 15) ‚Üí –ø–æ–≤—Ç–æ—Ä–Ω—ã–π –∑–∞–ø—Ä–æ—Å

### –ü—Ä–µ—Ä—ã–≤–∞–Ω–∏–µ —Ä–∞–±–æ—Ç—ã
- `Ctrl+C` ‚Üí –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –≤—ã—Ö–æ–¥ —Å —Å–æ–æ–±—â–µ–Ω–∏–µ–º
  ```
  –ü—Ä–æ–≥—Ä–∞–º–º–∞ –ø—Ä–µ—Ä–≤–∞–Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º
  ```

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –ö–ª–∞—Å—Å ModbusCLI
```python
class ModbusCLI:
    # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î
    __init__(db_path)
    connect_db()
    close_db()

    # UI —É—Ç–∏–ª–∏—Ç—ã
    clear_screen()
    print_header(text)
    print_menu(title, options)
    get_choice(max_option)
    pause()

    # –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é
    main_menu()

    # –ü—Ä–æ—Å–º–æ—Ç—Ä —Ä–µ–≥–∏—Å—Ç—Ä–æ–≤
    view_registers_menu()
    view_registers(filter_params)
    view_registers_by_section()
    view_registers_by_datatype()

    # CRUD –æ–ø–µ—Ä–∞—Ü–∏–∏
    add_register()
    edit_register()
    delete_register()

    # –ü–æ–∏—Å–∫ –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
    search_registers()
    show_statistics()

    # –≠–∫—Å–ø–æ—Ä—Ç
    export_to_excel()

    # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–µ–∫—Ü–∏—è–º–∏
    sections_menu()
    view_sections()
    add_section()
    delete_section()

    # –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ –º–µ—Ç–æ–¥—ã
    get_register_types()
    get_sections(register_type_id)
    get_datatypes()
    select_register_type()
    select_section(register_type_id)
    select_datatype()
    input_int(prompt, min_val, max_val)
```

### –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
- **sqlite3**: –†–∞–±–æ—Ç–∞ —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö
- **subprocess**: –ó–∞–ø—É—Å–∫ export_to_excel.py
- **pathlib**: –†–∞–±–æ—Ç–∞ —Å –ø—É—Ç—è–º–∏ —Ñ–∞–π–ª–æ–≤
- **sys, os**: –°–∏—Å—Ç–µ–º–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏

## –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–∞–±–ª–∏—Ü
```sql
registers
‚îú‚îÄ‚îÄ id (PRIMARY KEY)
‚îú‚îÄ‚îÄ register_type_id (FK ‚Üí register_types)
‚îú‚îÄ‚îÄ section_id (FK ‚Üí sections)
‚îú‚îÄ‚îÄ register_address (0-65535)
‚îú‚îÄ‚îÄ bit_index (NULL –∏–ª–∏ 0-15 –¥–ª—è BOOL)
‚îú‚îÄ‚îÄ data_type_id (FK ‚Üí data_types)
‚îú‚îÄ‚îÄ variable_name (NOT NULL)
‚îú‚îÄ‚îÄ description (NULL)
‚îú‚îÄ‚îÄ is_reserved (BOOLEAN)
‚îú‚îÄ‚îÄ created_at (TIMESTAMP)
‚îî‚îÄ‚îÄ updated_at (TIMESTAMP)

UNIQUE(register_type_id, register_address, bit_index)
```

### Constraints
- **UNIQUE**: `(register_type_id, register_address, bit_index)`
- **CHECK**: `bit_index` –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å NULL –¥–ª—è –Ω–µ-BOOL —Ç–∏–ø–æ–≤
- **FOREIGN KEYS**: –í–∫–ª—é—á–µ–Ω—ã —Å –ø–æ–º–æ—â—å—é `PRAGMA foreign_keys = ON`

## –§–∞–π–ª—ã –ø—Ä–æ–µ–∫—Ç–∞

```
script/
‚îú‚îÄ‚îÄ modbus_cli.py           # –ì–ª–∞–≤–Ω—ã–π —Å–∫—Ä–∏–ø—Ç CLI
‚îú‚îÄ‚îÄ modbus_cli.sh           # Shell launcher
‚îú‚îÄ‚îÄ export_to_excel.py      # –°–∫—Ä–∏–ø—Ç —ç–∫—Å–ø–æ—Ä—Ç–∞ –≤ Excel
‚îú‚îÄ‚îÄ README_CLI.md           # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è (—ç—Ç–æ—Ç —Ñ–∞–π–ª)
‚îî‚îÄ‚îÄ db/
    ‚îî‚îÄ‚îÄ modbus_registers.db # –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö SQLite
```

## –ò–∑–≤–µ—Å—Ç–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

1. **–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∞–¥—Ä–µ—Å–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞**: –ù–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ (—Ç—Ä–µ–±—É–µ—Ç —Å–ª–æ–∂–Ω–æ–π –≤–∞–ª–∏–¥–∞—Ü–∏–∏)
2. **–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–µ–∫—Ü–∏–∏**: –ó–∞–≥–ª—É—à–∫–∞ (TODO)
3. **–ú–∞—Å—Å–æ–≤–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ**: –¢–æ–ª—å–∫–æ –ø–æ –æ–¥–Ω–æ–º—É —Ä–µ–≥–∏—Å—Ç—Ä—É
4. **–≠–∫—Å–ø–æ—Ä—Ç –≤ –¥—Ä—É–≥–∏–µ —Ñ–æ—Ä–º–∞—Ç—ã**: –¢–æ–ª—å–∫–æ Excel (—á–µ—Ä–µ–∑ –≤–Ω–µ—à–Ω–∏–π —Å–∫—Ä–∏–ø—Ç)
5. **–ü–∞–≥–∏–Ω–∞—Ü–∏—è**: –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ª–∏–º–∏—Ç 50/100 –∑–∞–ø–∏—Å–µ–π
6. **–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –¥–∏–∞–ø–∞–∑–æ–Ω—É**: –¢–æ–ª—å–∫–æ –ø–æ–∏—Å–∫ –ø–æ —Ç–µ–∫—Å—Ç—É

## –ë—É–¥—É—â–∏–µ —É–ª—É—á—à–µ–Ω–∏—è

- [ ] –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∞–¥—Ä–µ—Å–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞
- [ ] –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–µ–∫—Ü–∏–∏
- [ ] –ú–∞—Å—Å–æ–≤–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ/—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- [ ] –≠–∫—Å–ø–æ—Ä—Ç –≤ JSON/CSV
- [ ] –ò–º–ø–æ—Ä—Ç –∏–∑ JSON/CSV
- [ ] –ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π (audit log)
- [ ] –†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –ë–î
- [ ] –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º–∞—è –ø–∞–≥–∏–Ω–∞—Ü–∏—è
- [ ] –§–∏–ª—å—Ç—Ä –ø–æ –¥–∏–∞–ø–∞–∑–æ–Ω—É –∞–¥—Ä–µ—Å–æ–≤
- [ ] –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π –ø–æ–∏—Å–∫ (regex)
- [ ] –í–∞–ª–∏–¥–∞—Ü–∏—è –∏–º—ë–Ω –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –ø–æ –ø—Ä–∞–≤–∏–ª–∞–º IEC 61131-3

## –õ–∏—Ü–µ–Ω–∑–∏—è

–†–∞–∑—Ä–∞–±–æ—Ç–∞–Ω–æ –¥–ª—è –ø—Ä–æ–µ–∫—Ç–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–æ–Ω–≤–µ–π–µ—Ä–Ω—ã–º–∏ —Å–∏—Å—Ç–µ–º–∞–º–∏.
–ê–≤—Ç–æ—Ä: Claude Code
–î–∞—Ç–∞: 2025-12-26

## –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –ø—Ä–æ–±–ª–µ–º:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞–ª–∏—á–∏–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö: `script/db/modbus_registers.db`
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —É—Å—Ç–∞–Ω–æ–≤–∫—É openpyxl: `python3 -c "import openpyxl"`
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ –Ω–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ: `chmod +x modbus_cli.sh`
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –æ—à–∏–±–æ–∫ –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª–µ

–î–ª—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –ë–î –∏–∑ FB_ModbusToSCADA.st:
```bash
cd script
python3 migrate_from_fc.py
```
